<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.slim.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<!---->
    <div class="wrapper fadeInDown">
        <div id="formContent">
             -->
            <!-- Tabs Titles -->

            <!-- Icon-->
            <br />
            <div class="fadeIn first">
                <h3 class="title">Fa√ßa Login aqui</h3>
            </div><br />
 
            <!-- Login Form -->
            <form id="formLogin">
                <input type="text" id="login" class="fadeIn second" name="username" placeholder="login">
                <input type="password" id="password" class="fadeIn third" name="password" placeholder="password">
                <input type="submit" class="fadeIn fourth">
            </form>

            <div id="formFooter">
                <a class="underlineHover" href="#">Quero me cadastrar</a>
            </div>

        </div>
    </div>
   

<form id="chat" style="display: none">
    <label id="username" for="username"></label>
    <div class="messages"></div>
    <input  name="message" type="text" name="message" placeholder="Digite a mensagem">
    <button class="send" type="submit">Enviar</button> 
</form>

<script >
    var socket = io('http://localhost:3000');

    function renderMessage(message){
        $(".messages").append('<dic class="message"><strong>'+message.author+' - </strong>'+
            message.message+'</div><br/>');
    }

    socket.on("receivedMessage", function(message){
        renderMessage(message);
    });
    socket.on("teste",function(hi){
        console.log(hi);
    });

    socket.on("logged", function(result){
        $("#chat").show();
        $(".wrapper").hide();
        $("#username").append("<div class=username>"+result[0].nome+"</div>");
        console.log(result);
    });
   
    $("#formLogin").submit(function(e){
        e.preventDefault();   
        var username = $("#login").val();
        var password = $("#password").val();

        var loginObject = {
            username: username,
            password: password
        };

    socket.emit('login', loginObject);
    });

    $("#chat").submit(function(e){
        e.preventDefault();   
        //$("#chat").hide();
    var author = $(".username").text();
    var message = $('input[name=message]').val();

    if(message.length){
        var messageObjetc = {
            author: author,
            message: message
        };
        renderMessage(messageObjetc);
        socket.emit('sendMessage', messageObjetc);
    }
});

</script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

</body>
</html>